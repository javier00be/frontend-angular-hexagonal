<div class="p-4 max-w-7xl mx-auto">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
        <div>
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white m-0">Gestión de Telas</h1>
            <p class="text-base text-gray-600 dark:text-gray-400 mt-2 mb-0">Administra las telas de productos</p>
        </div>
        <p-button label="Nueva Tela" icon="pi pi-plus" (onClick)="addNewFabric()" severity="success"></p-button>
    </div>
    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>
    <div *ngIf="fabricState.isLoading()" class="flex flex-col items-center justify-center py-16 px-8 gap-4">
        <p-progressSpinner></p-progressSpinner>
        <p class="text-gray-600 dark:text-gray-400 text-base">Cargando telas...</p>
    </div>
    <p-message *ngIf="fabricState.error()" severity="error" [text]="fabricState.error()!" styleClass="mb-6"></p-message>
    <div *ngIf="!fabricState.isLoading() && !fabricState.error()">
        <div *ngIf="fabricState.fabrics().length === 0" class="bg-white dark:bg-gray-800 rounded-lg">
            <div class="flex flex-col items-center justify-center py-16 px-4">
                <div class="bg-blue-50 dark:bg-blue-900/20 rounded-full p-6 mb-6">
                    <i class="pi pi-th-large text-6xl text-blue-600 dark:text-blue-400"></i>
                </div>
                <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-2">No hay telas registradas</h3>
                <p class="text-gray-600 dark:text-gray-400 text-center mb-6 max-w-md">No tiene telas por el momento.
                    Comience agregando su primera tela.</p>
                <p-button label="Registrar Nueva Tela" icon="pi pi-plus" (onClick)="addNewFabric()"
                    severity="success"></p-button>
            </div>
        </div>
        <p-table *ngIf="fabricState.fabrics().length > 0" [value]="fabricState.fabrics()" [paginator]="true" [rows]="10"
            [globalFilterFields]="['nombre', 'descripcion']" [tableStyle]="{ 'min-width': '50rem' }"
            styleClass="p-datatable-sm">
            <ng-template pTemplate="caption">
                <div class="flex justify-between items-center">
                    <p-iconfield iconPosition="left">
                        <p-inputicon styleClass="pi pi-search"></p-inputicon>
                        <input pInputText type="text" [(ngModel)]="searchValue" placeholder="Buscar telas..."
                            class="w-full md:w-80" />
                    </p-iconfield>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="id" style="width: 10%">ID <p-sortIcon field="id"></p-sortIcon></th>
                    <th pSortableColumn="nombre" style="width: 25%">Nombre <p-sortIcon field="nombre"></p-sortIcon></th>
                    <th pSortableColumn="descripcion" style="width: 40%">Descripción <p-sortIcon
                            field="descripcion"></p-sortIcon></th>
                    <th pSortableColumn="activo" style="width: 10%">Estado <p-sortIcon field="activo"></p-sortIcon></th>
                    <th style="width: 15%">Acciones</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-fabric>
                <tr>
                    <td>{{ fabric.id }}</td>
                    <td class="font-semibold">{{ fabric.nombre }}</td>
                    <td>{{ fabric.descripcion }}</td>
                    <td><p-tag [value]="getStatusLabel(fabric.activo)"
                            [severity]="getStatusSeverity(fabric.activo)"></p-tag></td>
                    <td>
                        <div class="flex gap-2">
                            <p-button icon="pi pi-pencil" [outlined]="true" severity="info" size="small"
                                (onClick)="editFabric(fabric)" pTooltip="Editar"></p-button>
                            <p-button icon="pi pi-trash" [outlined]="true" severity="danger" size="small"
                                (onClick)="confirmDelete(fabric)" pTooltip="Eliminar"></p-button>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="5" class="text-center py-8 text-gray-500">No se encontraron telas que coincidan con la
                        búsqueda.</td>
                </tr>
            </ng-template>
        </p-table>
    </div>
    <app-fabric-form-modal [(visible)]="showFabricModal" [fabric]="selectedFabric" (onSave)="handleFabricSave($event)"
        (onCancel)="handleFabricCancel()"></app-fabric-form-modal>
</div>