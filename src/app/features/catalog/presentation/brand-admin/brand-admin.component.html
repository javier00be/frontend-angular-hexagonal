<div class="p-4 max-w-7xl mx-auto">
    <!-- Header -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
        <div>
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white m-0">Gestión de Marcas</h1>
            <p class="text-base text-gray-600 dark:text-gray-400 mt-2 mb-0">Administra las marcas de productos</p>
        </div>
        <p-button label="Nueva Marca" icon="pi pi-plus" (onClick)="addNewBrand()" severity="success"></p-button>
    </div>

    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>

    <!-- Loading State -->
    <div *ngIf="brandState.isLoading()" class="flex flex-col items-center justify-center py-16 px-8 gap-4">
        <p-progressSpinner></p-progressSpinner>
        <p class="text-gray-600 dark:text-gray-400 text-base">Cargando marcas...</p>
    </div>

    <!-- Error State -->
    <p-message *ngIf="brandState.error()" severity="error" [text]="brandState.error()!" styleClass="mb-6"></p-message>

    <!-- Brands Table -->
    <div *ngIf="!brandState.isLoading() && !brandState.error()">
        <!-- Empty State -->
        <div *ngIf="brandState.brands().length === 0" class="bg-white dark:bg-gray-800 rounded-lg">
            <div class="flex flex-col items-center justify-center py-16 px-4">
                <div class="bg-blue-50 dark:bg-blue-900/20 rounded-full p-6 mb-6">
                    <i class="pi pi-tag text-6xl text-blue-600 dark:text-blue-400"></i>
                </div>
                <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-2">No hay marcas registradas</h3>
                <p class="text-gray-600 dark:text-gray-400 text-center mb-6 max-w-md">
                    No tiene marcas por el momento. Comience agregando su primera marca.
                </p>
                <p-button label="Registrar Nueva Marca" icon="pi pi-plus" (onClick)="addNewBrand()"
                    severity="success"></p-button>
            </div>
        </div>

        <!-- Table with Data -->
        <p-table *ngIf="brandState.brands().length > 0" [value]="brandState.brands()" [paginator]="true" [rows]="10"
            [globalFilterFields]="['nombre']" [tableStyle]="{ 'min-width': '50rem' }" styleClass="p-datatable-sm">
            <ng-template pTemplate="caption">
                <div class="flex justify-between items-center">
                    <p-iconfield iconPosition="left">
                        <p-inputicon styleClass="pi pi-search"></p-inputicon>
                        <input pInputText type="text" [(ngModel)]="searchValue" placeholder="Buscar marcas..."
                            class="w-full md:w-80" />
                    </p-iconfield>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="id" style="width: 15%">
                        ID <p-sortIcon field="id"></p-sortIcon>
                    </th>
                    <th pSortableColumn="nombre" style="width: 55%">
                        Nombre <p-sortIcon field="nombre"></p-sortIcon>
                    </th>
                    <th pSortableColumn="estado" style="width: 15%">
                        Estado <p-sortIcon field="estado"></p-sortIcon>
                    </th>
                    <th style="width: 15%">Acciones</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-brand>
                <tr>
                    <td>{{ brand.id }}</td>
                    <td class="font-semibold">{{ brand.nombre }}</td>
                    <td>
                        <p-tag [value]="getStatusLabel(brand.estado)"
                            [severity]="getStatusSeverity(brand.estado)"></p-tag>
                    </td>
                    <td>
                        <div class="flex gap-2">
                            <p-button icon="pi pi-pencil" [outlined]="true" severity="info" size="small"
                                (onClick)="editBrand(brand)" pTooltip="Editar"></p-button>
                            <p-button icon="pi pi-trash" [outlined]="true" severity="danger" size="small"
                                (onClick)="confirmDelete(brand)" pTooltip="Eliminar"></p-button>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="4" class="text-center py-8 text-gray-500">
                        No se encontraron marcas que coincidan con la búsqueda.
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>

    <!-- Brand Form Modal -->
    <app-brand-form-modal [(visible)]="showBrandModal" [brand]="selectedBrand" (onSave)="handleBrandSave($event)"
        (onCancel)="handleBrandCancel()">
    </app-brand-form-modal>
</div>